---
server:
  port: 8080
spring:
  application:
    name: "seed-gateway"
  profiles:
    active: "${SPRING_PROFILES_ACTIVE:dev}"
  threads:
    virtual:
      enabled: true
  cloud:
    nacos:
      username: "${NACOS_USERNAME:nacos}"
      password: "${NACOS_PASSWORD:nacos}"
      discovery:
        server-addr: "${NACOS_SERVER_ADDR:localhost:8848}"
        namespace: "${NACOS_NAMESPACE:}"
        # 开发环境下，网关实例注册为本机地址，防止服务发现时出现无法访问的问题
        ip: "${NACOS_DISCOVERY_IP:127.0.0.1}"
      config:
        enabled: "${NACOS_CONFIG_ENABLED:false}"
        server-addr: "${NACOS_SERVER_ADDR:localhost:8848}"
        namespace: "${NACOS_NAMESPACE:}"
        file-extension: yaml
        shared-configs:
          - data-id: application-shared.yaml
            group: DEFAULT_GROUP
            refresh: true
          - data-id: application-redis.yaml
            group: DEFAULT_GROUP
            refresh: true
    gateway:
      discovery:
        locator:
          enabled: true
          lower-case-service-id: true
      routes:
      - id: "seed-auth"
        uri: "lb://seed-auth"
        predicates:
        - "Path=/auth/**"
        filters:
        - "StripPrefix=0"
      - id: "seed-system"
        uri: "lb://seed-system"
        predicates:
        - "Path=/system/**"
        filters:
        - "StripPrefix=0"
    sentinel:
      transport:
        dashboard: "${SENTINEL_DASHBOARD:localhost:8858}"
      eager: true
  data:
    redis:
      host: "${REDIS_HOST:localhost}"
      port: "${REDIS_PORT:6379}"
      database: 0
      lettuce:
        pool:
          max-active: 16
          max-idle: 8
          min-idle: 2
          max-wait: "1000ms"
        shutdown-timeout: "100ms"
sa-token:
  token-name: "Authorization"
  timeout: 86400
  active-timeout: -1
  is-concurrent: true
  is-share: true
  token-prefix: "Bearer"
  is-read-header: true
  is-read-cookie: true
seed:
  auth:
    provider: "${AUTH_PROVIDER:satoken}"
    oauth2:
      issuer-uri: "${OAUTH2_ISSUER_URI:https://your-logto-instance.logto.app/oidc}"
      roles-claim: "roles"
      role-prefix: "ROLE_"
spring.security.oauth2.resourceserver.jwt.issuer-uri: "${OAUTH2_ISSUER_URI:https://your-logto-instance.logto.app/oidc}"
management:
  endpoints:
    web:
      exposure:
        include: "health,info,gateway,metrics"
logging:
  level:
    '[com.zhangzhankui.seed]': "info"
    '[org.springframework.cloud.gateway]': "info"
